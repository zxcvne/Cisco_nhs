2. 와이어샤크 필터 예제

 - '5-2.와이어샤크 필터 예제.pcap' 파일을 와이어샤크로 오픈한다.

		PC					서버
		192.168.1.254				192.168.1.201
		70:85:C2:0A:E8:F6				

 1) '192.168.1.201' ARP 요청 및 응답 내용 필터

 - ARP 요청 메세지
 - ARP 응답 메세지

(arp.opcode == 1 && arp.src.hw_mac == 70:85:C2:0A:E8:F6 && arp.src.proto_ipv4 == 192.168.1.254 && arp.dst.proto_ipv4 == 192.168.1.201) or (arp.opcode == 2 && arp.src.proto_ipv4 == 192.168.1.201 && arp.dst.hw_mac == 70:85:C2:0A:E8:F6 && arp.dst.proto_ipv4 == 192.168.1.254)

arp.opcode
arp.src.hw_mac
arp.src.proto_ipv4
arp.dst.hw_mac
arp.dst.proto_ipv4



 2) '192.168.1.201' TCP 3-Way 핸드 쉐이킹 & HTTP(TCP 80) 내용 필터

		PC					서버
		192.168.1.254				192.168.1.201			

		Syn(0x02) ->
		seq 0
							<- Syn+Ack(0x12)
				  			  seq 0, ack 1
		Ack(0x10) ->
		seq 1, ack 1

(ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && tcp.dstport == 80 && tcp.flags == 0x02 && tcp.seq == 0) or (ip.src == 192.168.1.201 && ip.dst == 192.168.1.254 && tcp.srcport == 80 && tcp.flags == 0x12 && tcp.seq == 0 && tcp.ack == 1) or (ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && tcp.dstport == 80 && tcp.flags == 0x10 && tcp.seq == 1 && tcp.ack == 1)

(ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && http) or (ip.src == 192.168.1.201 && ip.dst == 192.168.1.254 && http)



 3) '192.168.1.201' TCP 3-Way 핸드 쉐이킹 및 FTP(TCP 21) 내용 필터

		PC					서버
		192.168.1.254				192.168.1.201			

		Syn(0x02) ->
		seq 0
							<- Syn+Ack(0x12)
				  			  seq 0, ack 1
		Ack(0x10) ->
		seq 1, ack 1

(ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && tcp.dstport == 21 && tcp.flags == 0x02 && tcp.seq == 0) or (ip.src == 192.168.1.201 && ip.dst == 192.168.1.254 && tcp.srcport == 21 && tcp.flags == 0x12 && tcp.seq == 0 && tcp.ack == 1) or (ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && tcp.dstport == 21 && tcp.flags == 0x10 && tcp.seq == 1 && tcp.ack == 1)

(ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && ftp) or (ip.src == 192.168.1.201 && ip.dst == 192.168.1.254 && ftp)


 4) '192.168.1.201' TCP 3-Way 핸드 쉐이킹 & Telnet(TCP 23) 내용 필터

		PC					서버
		192.168.1.254				192.168.1.201			

		Syn(0x02) ->
		seq 0
							<- Syn+Ack(0x12)
				  			  seq 0, ack 1
		Ack(0x10) ->
		seq 1, ack 1

(ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && tcp.dstport == 23 && tcp.flags == 0x02 && tcp.seq == 0) or (ip.src == 192.168.1.201 && ip.dst == 192.168.1.254 && tcp.srcport == 23 && tcp.flags == 0x12 && tcp.seq == 0 && tcp.ack == 1) or (ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && tcp.dstport == 23 && tcp.flags == 0x10 && tcp.seq == 1 && tcp.ack == 1)

(ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && telnet) or (ip.src == 192.168.1.201 && ip.dst == 192.168.1.254 && telnet)


 5) '192.168.1.201' ICMP Echo-Request, ICMP Echo-Reply 내용 필터

		PC					서버
		192.168.1.254				192.168.1.201

		ICMP Echo-Request			ICMP Echo-Reply
		----------------------->	   	  <-----------------------
		SA 192.168.1.254				SA 192.168.1.201
		DA 192.168.1.201				DA 192.168.1.254

(ip.src == 192.168.1.254 && ip.dst == 192.168.1.201 && icmp.type == 8) or (ip.src == 192.168.1.201 && ip.dst == 192.168.1.254 && icmp.type == 0)


 6) PC에서 '168.126.63.1'으로 'www.naver.com'에 대한 DNS 요청 및 응답 내용 필터

		PC					서버
		192.168.1.254				168.126.63.1		

		DNS Query				DNS Response
		----------------------->	   	  <-----------------------
		SA 192.168.1.254				SA 168.126.63.1
		DA 168.126.63.1				DA 192.168.1.254

(ip.src == 192.168.1.254 && ip.dst == 168.126.63.1 && dns.qry.name == www.naver.com) or (ip.src == 168.126.63.1 && ip.dst == 192.168.1.254 && dns.resp.name == www.naver.com)



